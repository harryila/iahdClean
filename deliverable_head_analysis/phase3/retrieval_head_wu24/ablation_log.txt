======================================================================
Phase 3 Method 2 (Wu24) Ablation: instruct / inc_state / 2048 tokens
Ablation levels: [5, 10, 20, 30, 40, 50]
Random baseline: ENABLED
======================================================================
Loading data...
Valid test samples for inc_state: 33
Loaded 50 top heads from Phase 2 Wu24 results

Loading model: meta-llama/Meta-Llama-3-8B-Instruct
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:00<00:01,  1.62it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.58it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:01<00:00,  1.58it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  2.24it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.95it/s]
Total heads in model: 1024 (32 layers x 32 heads)

==================================================
BASELINE (no ablation)
==================================================
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]2026-02-05 03:46:16.831741: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1770263176.842229  447838 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1770263176.846654  447838 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1770263176.852246  447838 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1770263176.852266  447838 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1770263176.852268  447838 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1770263176.852270  447838 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
/home/ubuntu/.local/lib/python3.10/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.
  warnings.warn("Unable to import Axes3D. This may be due to multiple versions of "
/home/ubuntu/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:567: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/home/ubuntu/.local/lib/python3.10/site-packages/transformers/generation/configuration_utils.py:572: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
Evaluating:   3%|▎         | 1/33 [00:03<01:36,  3.03s/it]Evaluating:   6%|▌         | 2/33 [00:03<00:42,  1.37s/it]Evaluating:   9%|▉         | 3/33 [00:03<00:25,  1.18it/s]Evaluating:  12%|█▏        | 4/33 [00:03<00:17,  1.67it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:13,  2.08it/s]Evaluating:  18%|█▊        | 6/33 [00:04<00:09,  2.71it/s]Evaluating:  21%|██        | 7/33 [00:04<00:08,  3.08it/s]Evaluating:  24%|██▍       | 8/33 [00:04<00:07,  3.46it/s]Evaluating:  27%|██▋       | 9/33 [00:04<00:06,  3.78it/s]Evaluating:  30%|███       | 10/33 [00:04<00:05,  4.04it/s]Evaluating:  33%|███▎      | 11/33 [00:05<00:05,  4.25it/s]Evaluating:  36%|███▋      | 12/33 [00:05<00:04,  4.40it/s]Evaluating:  39%|███▉      | 13/33 [00:05<00:04,  4.89it/s]Evaluating:  42%|████▏     | 14/33 [00:05<00:03,  4.85it/s]Evaluating:  45%|████▌     | 15/33 [00:05<00:03,  4.80it/s]Evaluating:  48%|████▊     | 16/33 [00:06<00:03,  4.75it/s]Evaluating:  52%|█████▏    | 17/33 [00:06<00:03,  5.18it/s]Evaluating:  55%|█████▍    | 18/33 [00:06<00:03,  4.85it/s]Evaluating:  58%|█████▊    | 19/33 [00:06<00:02,  5.23it/s]Evaluating:  61%|██████    | 20/33 [00:06<00:02,  5.49it/s]Evaluating:  64%|██████▎   | 21/33 [00:07<00:02,  5.15it/s]Evaluating:  67%|██████▋   | 22/33 [00:07<00:02,  4.86it/s]Evaluating:  70%|██████▉   | 23/33 [00:07<00:02,  4.81it/s]Evaluating:  73%|███████▎  | 24/33 [00:07<00:01,  4.82it/s]Evaluating:  76%|███████▌  | 25/33 [00:07<00:01,  4.80it/s]Evaluating:  79%|███████▉  | 26/33 [00:08<00:01,  4.78it/s]Evaluating:  82%|████████▏ | 27/33 [00:08<00:01,  4.65it/s]Evaluating:  85%|████████▍ | 28/33 [00:08<00:01,  4.71it/s]Evaluating:  88%|████████▊ | 29/33 [00:08<00:00,  4.72it/s]Evaluating:  91%|█████████ | 30/33 [00:08<00:00,  5.12it/s]Evaluating:  94%|█████████▍| 31/33 [00:09<00:00,  5.45it/s]Evaluating:  97%|█████████▋| 32/33 [00:09<00:00,  5.13it/s]Evaluating: 100%|██████████| 33/33 [00:09<00:00,  4.99it/s]                                                           Baseline accuracy: 97.0% (32/33)

==================================================
TOP HEADS ABLATION (Incremental)
==================================================

--- Ablating top 5 heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.59it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.59it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:18,  1.59it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.58it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.54it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.56it/s]Evaluating:  21%|██        | 7/33 [00:04<00:16,  1.56it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:15,  1.57it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.58it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.58it/s]Evaluating:  33%|███▎      | 11/33 [00:06<00:13,  1.59it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.59it/s]Evaluating:  39%|███▉      | 13/33 [00:07<00:09,  2.06it/s]Evaluating:  42%|████▏     | 14/33 [00:08<00:10,  1.89it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:10,  1.79it/s]Evaluating:  48%|████▊     | 16/33 [00:09<00:09,  1.72it/s]Evaluating:  52%|█████▏    | 17/33 [00:09<00:07,  2.21it/s]Evaluating:  55%|█████▍    | 18/33 [00:10<00:07,  1.96it/s]Evaluating:  58%|█████▊    | 19/33 [00:11<00:07,  1.83it/s]Evaluating:  61%|██████    | 20/33 [00:11<00:05,  2.32it/s]Evaluating:  64%|██████▎   | 21/33 [00:11<00:05,  2.03it/s]Evaluating:  67%|██████▋   | 22/33 [00:12<00:05,  1.86it/s]Evaluating:  70%|██████▉   | 23/33 [00:13<00:05,  1.77it/s]Evaluating:  73%|███████▎  | 24/33 [00:13<00:05,  1.71it/s]Evaluating:  76%|███████▌  | 25/33 [00:14<00:04,  1.68it/s]Evaluating:  79%|███████▉  | 26/33 [00:15<00:04,  1.65it/s]Evaluating:  82%|████████▏ | 27/33 [00:15<00:03,  1.62it/s]Evaluating:  85%|████████▍ | 28/33 [00:16<00:03,  1.61it/s]Evaluating:  88%|████████▊ | 29/33 [00:16<00:02,  1.61it/s]Evaluating:  91%|█████████ | 30/33 [00:17<00:01,  2.07it/s]Evaluating:  94%|█████████▍| 31/33 [00:17<00:01,  1.90it/s]Evaluating:  97%|█████████▋| 32/33 [00:18<00:00,  1.79it/s]Evaluating: 100%|██████████| 33/33 [00:18<00:00,  1.72it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating top 10 heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.59it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.59it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.58it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.56it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.52it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.54it/s]Evaluating:  21%|██        | 7/33 [00:04<00:16,  1.54it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.55it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.56it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.57it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:13,  1.58it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.58it/s]Evaluating:  39%|███▉      | 13/33 [00:07<00:09,  2.05it/s]Evaluating:  42%|████▏     | 14/33 [00:08<00:10,  1.89it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:10,  1.78it/s]Evaluating:  48%|████▊     | 16/33 [00:09<00:09,  1.71it/s]Evaluating:  52%|█████▏    | 17/33 [00:09<00:07,  2.20it/s]Evaluating:  55%|█████▍    | 18/33 [00:10<00:07,  1.95it/s]Evaluating:  58%|█████▊    | 19/33 [00:11<00:07,  1.82it/s]Evaluating:  61%|██████    | 20/33 [00:11<00:07,  1.73it/s]Evaluating:  64%|██████▎   | 21/33 [00:12<00:07,  1.68it/s]Evaluating:  67%|██████▋   | 22/33 [00:13<00:06,  1.63it/s]Evaluating:  70%|██████▉   | 23/33 [00:13<00:06,  1.61it/s]Evaluating:  73%|███████▎  | 24/33 [00:14<00:05,  1.61it/s]Evaluating:  76%|███████▌  | 25/33 [00:14<00:04,  1.60it/s]Evaluating:  79%|███████▉  | 26/33 [00:15<00:04,  1.60it/s]Evaluating:  82%|████████▏ | 27/33 [00:16<00:03,  1.58it/s]Evaluating:  85%|████████▍ | 28/33 [00:16<00:03,  1.58it/s]Evaluating:  88%|████████▊ | 29/33 [00:17<00:02,  1.59it/s]Evaluating:  91%|█████████ | 30/33 [00:17<00:01,  2.04it/s]Evaluating:  94%|█████████▍| 31/33 [00:18<00:01,  1.88it/s]Evaluating:  97%|█████████▋| 32/33 [00:18<00:00,  1.77it/s]Evaluating: 100%|██████████| 33/33 [00:19<00:00,  1.71it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating top 20 heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.58it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.58it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.58it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.56it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.52it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.54it/s]Evaluating:  21%|██        | 7/33 [00:04<00:16,  1.54it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.55it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.56it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.56it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.56it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.57it/s]Evaluating:  39%|███▉      | 13/33 [00:08<00:12,  1.57it/s]Evaluating:  42%|████▏     | 14/33 [00:08<00:12,  1.57it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:11,  1.57it/s]Evaluating:  48%|████▊     | 16/33 [00:10<00:10,  1.57it/s]Evaluating:  52%|█████▏    | 17/33 [00:10<00:10,  1.57it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:09,  1.55it/s]Evaluating:  58%|█████▊    | 19/33 [00:12<00:09,  1.55it/s]Evaluating:  61%|██████    | 20/33 [00:12<00:08,  1.56it/s]Evaluating:  64%|██████▎   | 21/33 [00:13<00:07,  1.55it/s]Evaluating:  67%|██████▋   | 22/33 [00:14<00:07,  1.54it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.55it/s]Evaluating:  73%|███████▎  | 24/33 [00:15<00:05,  1.55it/s]Evaluating:  76%|███████▌  | 25/33 [00:16<00:05,  1.56it/s]Evaluating:  79%|███████▉  | 26/33 [00:16<00:04,  1.56it/s]Evaluating:  82%|████████▏ | 27/33 [00:17<00:03,  1.55it/s]Evaluating:  85%|████████▍ | 28/33 [00:17<00:03,  1.56it/s]Evaluating:  88%|████████▊ | 29/33 [00:18<00:02,  1.56it/s]Evaluating:  91%|█████████ | 30/33 [00:18<00:01,  2.02it/s]Evaluating:  94%|█████████▍| 31/33 [00:19<00:01,  1.86it/s]Evaluating:  97%|█████████▋| 32/33 [00:20<00:00,  1.75it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.69it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating top 30 heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.58it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.57it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.56it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.55it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.51it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.53it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.52it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.53it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.54it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.54it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.55it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.55it/s]Evaluating:  39%|███▉      | 13/33 [00:08<00:12,  1.56it/s]Evaluating:  42%|████▏     | 14/33 [00:09<00:12,  1.56it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:11,  1.55it/s]Evaluating:  48%|████▊     | 16/33 [00:10<00:10,  1.55it/s]Evaluating:  52%|█████▏    | 17/33 [00:10<00:10,  1.56it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:09,  1.54it/s]Evaluating:  58%|█████▊    | 19/33 [00:12<00:09,  1.54it/s]Evaluating:  61%|██████    | 20/33 [00:12<00:08,  1.54it/s]Evaluating:  64%|██████▎   | 21/33 [00:13<00:07,  1.54it/s]Evaluating:  67%|██████▋   | 22/33 [00:14<00:07,  1.53it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.54it/s]Evaluating:  73%|███████▎  | 24/33 [00:15<00:05,  1.54it/s]Evaluating:  76%|███████▌  | 25/33 [00:16<00:05,  1.55it/s]Evaluating:  79%|███████▉  | 26/33 [00:16<00:04,  1.55it/s]Evaluating:  82%|████████▏ | 27/33 [00:17<00:03,  1.54it/s]Evaluating:  85%|████████▍ | 28/33 [00:18<00:03,  1.55it/s]Evaluating:  88%|████████▊ | 29/33 [00:18<00:02,  1.55it/s]Evaluating:  91%|█████████ | 30/33 [00:18<00:01,  2.00it/s]Evaluating:  94%|█████████▍| 31/33 [00:19<00:01,  1.84it/s]Evaluating:  97%|█████████▋| 32/33 [00:20<00:00,  1.74it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.68it/s]                                                           Accuracy: 90.9% (drop: 6.1%)

--- Ablating top 40 heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.54it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:20,  1.55it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.55it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.53it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.49it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.51it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.51it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.52it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.52it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.54it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.54it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.54it/s]Evaluating:  39%|███▉      | 13/33 [00:08<00:12,  1.55it/s]Evaluating:  42%|████▏     | 14/33 [00:09<00:12,  1.55it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:11,  1.55it/s]Evaluating:  48%|████▊     | 16/33 [00:10<00:10,  1.55it/s]Evaluating:  52%|█████▏    | 17/33 [00:11<00:10,  1.56it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:09,  1.54it/s]Evaluating:  58%|█████▊    | 19/33 [00:12<00:09,  1.55it/s]Evaluating:  61%|██████    | 20/33 [00:13<00:08,  1.54it/s]Evaluating:  64%|██████▎   | 21/33 [00:13<00:07,  1.54it/s]Evaluating:  67%|██████▋   | 22/33 [00:14<00:07,  1.53it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.53it/s]Evaluating:  73%|███████▎  | 24/33 [00:15<00:05,  1.53it/s]Evaluating:  76%|███████▌  | 25/33 [00:16<00:05,  1.54it/s]Evaluating:  79%|███████▉  | 26/33 [00:16<00:04,  1.54it/s]Evaluating:  82%|████████▏ | 27/33 [00:17<00:03,  1.53it/s]Evaluating:  85%|████████▍ | 28/33 [00:18<00:03,  1.54it/s]Evaluating:  88%|████████▊ | 29/33 [00:18<00:02,  1.54it/s]Evaluating:  91%|█████████ | 30/33 [00:19<00:01,  1.98it/s]Evaluating:  94%|█████████▍| 31/33 [00:19<00:01,  1.83it/s]Evaluating:  97%|█████████▋| 32/33 [00:20<00:00,  1.73it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.67it/s]                                                           Accuracy: 84.8% (drop: 12.1%)

--- Ablating top 50 heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.53it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:20,  1.54it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.53it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:19,  1.51it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.48it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:18,  1.50it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.49it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.50it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.51it/s]Evaluating:  30%|███       | 10/33 [00:06<00:15,  1.52it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.53it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.53it/s]Evaluating:  39%|███▉      | 13/33 [00:08<00:13,  1.53it/s]Evaluating:  42%|████▏     | 14/33 [00:09<00:12,  1.53it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:11,  1.53it/s]Evaluating:  48%|████▊     | 16/33 [00:10<00:11,  1.53it/s]Evaluating:  52%|█████▏    | 17/33 [00:11<00:10,  1.54it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:09,  1.51it/s]Evaluating:  58%|█████▊    | 19/33 [00:12<00:09,  1.52it/s]Evaluating:  61%|██████    | 20/33 [00:13<00:08,  1.52it/s]Evaluating:  64%|██████▎   | 21/33 [00:13<00:07,  1.51it/s]Evaluating:  67%|██████▋   | 22/33 [00:14<00:07,  1.50it/s]Evaluating:  70%|██████▉   | 23/33 [00:15<00:06,  1.51it/s]Evaluating:  73%|███████▎  | 24/33 [00:15<00:05,  1.52it/s]Evaluating:  76%|███████▌  | 25/33 [00:16<00:05,  1.52it/s]Evaluating:  79%|███████▉  | 26/33 [00:17<00:04,  1.52it/s]Evaluating:  82%|████████▏ | 27/33 [00:17<00:03,  1.51it/s]Evaluating:  85%|████████▍ | 28/33 [00:18<00:03,  1.52it/s]Evaluating:  88%|████████▊ | 29/33 [00:19<00:02,  1.52it/s]Evaluating:  91%|█████████ | 30/33 [00:19<00:01,  1.97it/s]Evaluating:  94%|█████████▍| 31/33 [00:19<00:01,  1.81it/s]Evaluating:  97%|█████████▋| 32/33 [00:20<00:00,  1.70it/s]Evaluating: 100%|██████████| 33/33 [00:21<00:00,  1.65it/s]                                                           Accuracy: 78.8% (drop: 18.2%)

==================================================
RANDOM HEADS ABLATION (Baseline comparison)
==================================================

--- Ablating 5 random heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.60it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.60it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:12,  2.41it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:14,  1.99it/s]Evaluating:  15%|█▌        | 5/33 [00:02<00:15,  1.75it/s]Evaluating:  18%|█▊        | 6/33 [00:02<00:11,  2.33it/s]Evaluating:  21%|██        | 7/33 [00:03<00:13,  2.00it/s]Evaluating:  24%|██▍       | 8/33 [00:03<00:09,  2.55it/s]Evaluating:  27%|██▋       | 9/33 [00:04<00:11,  2.15it/s]Evaluating:  30%|███       | 10/33 [00:04<00:11,  1.94it/s]Evaluating:  33%|███▎      | 11/33 [00:05<00:08,  2.47it/s]Evaluating:  36%|███▋      | 12/33 [00:05<00:09,  2.12it/s]Evaluating:  39%|███▉      | 13/33 [00:05<00:07,  2.67it/s]Evaluating:  42%|████▏     | 14/33 [00:06<00:05,  3.22it/s]Evaluating:  45%|████▌     | 15/33 [00:06<00:07,  2.45it/s]Evaluating:  48%|████▊     | 16/33 [00:07<00:08,  2.11it/s]Evaluating:  52%|█████▏    | 17/33 [00:07<00:06,  2.64it/s]Evaluating:  55%|█████▍    | 18/33 [00:08<00:06,  2.18it/s]Evaluating:  58%|█████▊    | 19/33 [00:08<00:05,  2.71it/s]Evaluating:  61%|██████    | 20/33 [00:08<00:04,  3.25it/s]Evaluating:  64%|██████▎   | 21/33 [00:09<00:04,  2.46it/s]Evaluating:  67%|██████▋   | 22/33 [00:09<00:05,  2.10it/s]Evaluating:  70%|██████▉   | 23/33 [00:10<00:05,  1.91it/s]Evaluating:  73%|███████▎  | 24/33 [00:10<00:04,  1.81it/s]Evaluating:  76%|███████▌  | 25/33 [00:11<00:04,  1.74it/s]Evaluating:  79%|███████▉  | 26/33 [00:12<00:04,  1.69it/s]Evaluating:  82%|████████▏ | 27/33 [00:12<00:03,  1.64it/s]Evaluating:  85%|████████▍ | 28/33 [00:13<00:03,  1.63it/s]Evaluating:  88%|████████▊ | 29/33 [00:14<00:02,  1.62it/s]Evaluating:  91%|█████████ | 30/33 [00:14<00:01,  2.08it/s]Evaluating:  94%|█████████▍| 31/33 [00:14<00:00,  2.61it/s]Evaluating:  97%|█████████▋| 32/33 [00:15<00:00,  2.19it/s]Evaluating: 100%|██████████| 33/33 [00:15<00:00,  2.71it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating 10 random heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.59it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.58it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:18,  1.58it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.56it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.52it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.54it/s]Evaluating:  21%|██        | 7/33 [00:04<00:16,  1.54it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.55it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.56it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.57it/s]Evaluating:  33%|███▎      | 11/33 [00:06<00:10,  2.04it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:11,  1.87it/s]Evaluating:  39%|███▉      | 13/33 [00:07<00:08,  2.39it/s]Evaluating:  42%|████▏     | 14/33 [00:07<00:09,  2.07it/s]Evaluating:  45%|████▌     | 15/33 [00:08<00:09,  1.90it/s]Evaluating:  48%|████▊     | 16/33 [00:09<00:09,  1.79it/s]Evaluating:  52%|█████▏    | 17/33 [00:09<00:06,  2.30it/s]Evaluating:  55%|█████▍    | 18/33 [00:09<00:05,  2.71it/s]Evaluating:  58%|█████▊    | 19/33 [00:09<00:04,  3.28it/s]Evaluating:  61%|██████    | 20/33 [00:09<00:03,  3.80it/s]Evaluating:  64%|██████▎   | 21/33 [00:10<00:04,  2.66it/s]Evaluating:  67%|██████▋   | 22/33 [00:11<00:05,  2.16it/s]Evaluating:  70%|██████▉   | 23/33 [00:11<00:05,  1.95it/s]Evaluating:  73%|███████▎  | 24/33 [00:12<00:04,  1.82it/s]Evaluating:  76%|███████▌  | 25/33 [00:13<00:04,  1.74it/s]Evaluating:  79%|███████▉  | 26/33 [00:13<00:04,  1.69it/s]Evaluating:  82%|████████▏ | 27/33 [00:14<00:03,  1.64it/s]Evaluating:  85%|████████▍ | 28/33 [00:15<00:03,  1.63it/s]Evaluating:  88%|████████▊ | 29/33 [00:15<00:02,  1.62it/s]Evaluating:  91%|█████████ | 30/33 [00:15<00:01,  2.08it/s]Evaluating:  94%|█████████▍| 31/33 [00:15<00:00,  2.60it/s]Evaluating:  97%|█████████▋| 32/33 [00:16<00:00,  2.17it/s]Evaluating: 100%|██████████| 33/33 [00:17<00:00,  1.95it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating 20 random heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.56it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.56it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.55it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.54it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.51it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.52it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.52it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.53it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.54it/s]Evaluating:  30%|███       | 10/33 [00:06<00:14,  1.55it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.56it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.56it/s]Evaluating:  39%|███▉      | 13/33 [00:07<00:09,  2.02it/s]Evaluating:  42%|████▏     | 14/33 [00:08<00:10,  1.86it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:10,  1.76it/s]Evaluating:  48%|████▊     | 16/33 [00:09<00:10,  1.69it/s]Evaluating:  52%|█████▏    | 17/33 [00:10<00:09,  1.66it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:09,  1.61it/s]Evaluating:  58%|█████▊    | 19/33 [00:11<00:08,  1.59it/s]Evaluating:  61%|██████    | 20/33 [00:12<00:08,  1.58it/s]Evaluating:  64%|██████▎   | 21/33 [00:13<00:07,  1.57it/s]Evaluating:  67%|██████▋   | 22/33 [00:13<00:07,  1.54it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.55it/s]Evaluating:  73%|███████▎  | 24/33 [00:15<00:05,  1.55it/s]Evaluating:  76%|███████▌  | 25/33 [00:15<00:05,  1.56it/s]Evaluating:  79%|███████▉  | 26/33 [00:16<00:04,  1.56it/s]Evaluating:  82%|████████▏ | 27/33 [00:16<00:03,  1.55it/s]Evaluating:  85%|████████▍ | 28/33 [00:17<00:03,  1.56it/s]Evaluating:  88%|████████▊ | 29/33 [00:18<00:02,  1.56it/s]Evaluating:  91%|█████████ | 30/33 [00:18<00:01,  2.01it/s]Evaluating:  94%|█████████▍| 31/33 [00:19<00:01,  1.85it/s]Evaluating:  97%|█████████▋| 32/33 [00:19<00:00,  1.75it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.68it/s]                                                           Accuracy: 100.0% (drop: -3.0%)

--- Ablating 30 random heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.56it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.56it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.55it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.53it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.49it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.51it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.51it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.52it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.53it/s]Evaluating:  30%|███       | 10/33 [00:06<00:15,  1.53it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.54it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.55it/s]Evaluating:  39%|███▉      | 13/33 [00:07<00:09,  2.00it/s]Evaluating:  42%|████▏     | 14/33 [00:08<00:10,  1.84it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:10,  1.74it/s]Evaluating:  48%|████▊     | 16/33 [00:09<00:10,  1.68it/s]Evaluating:  52%|█████▏    | 17/33 [00:10<00:07,  2.16it/s]Evaluating:  55%|█████▍    | 18/33 [00:10<00:07,  1.90it/s]Evaluating:  58%|█████▊    | 19/33 [00:11<00:07,  1.77it/s]Evaluating:  61%|██████    | 20/33 [00:12<00:07,  1.69it/s]Evaluating:  64%|██████▎   | 21/33 [00:12<00:07,  1.64it/s]Evaluating:  67%|██████▋   | 22/33 [00:13<00:06,  1.59it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.58it/s]Evaluating:  73%|███████▎  | 24/33 [00:14<00:05,  1.57it/s]Evaluating:  76%|███████▌  | 25/33 [00:15<00:05,  1.57it/s]Evaluating:  79%|███████▉  | 26/33 [00:15<00:04,  1.56it/s]Evaluating:  82%|████████▏ | 27/33 [00:16<00:03,  1.54it/s]Evaluating:  85%|████████▍ | 28/33 [00:17<00:03,  1.55it/s]Evaluating:  88%|████████▊ | 29/33 [00:17<00:02,  1.55it/s]Evaluating:  91%|█████████ | 30/33 [00:18<00:01,  2.00it/s]Evaluating:  94%|█████████▍| 31/33 [00:18<00:01,  1.84it/s]Evaluating:  97%|█████████▋| 32/33 [00:19<00:00,  1.73it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.67it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating 40 random heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.54it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:20,  1.54it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.54it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.53it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.49it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.51it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.50it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.52it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.52it/s]Evaluating:  30%|███       | 10/33 [00:06<00:15,  1.53it/s]Evaluating:  33%|███▎      | 11/33 [00:07<00:14,  1.54it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:13,  1.54it/s]Evaluating:  39%|███▉      | 13/33 [00:08<00:12,  1.55it/s]Evaluating:  42%|████▏     | 14/33 [00:09<00:12,  1.55it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:11,  1.55it/s]Evaluating:  48%|████▊     | 16/33 [00:10<00:10,  1.55it/s]Evaluating:  52%|█████▏    | 17/33 [00:10<00:07,  2.00it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:08,  1.82it/s]Evaluating:  58%|█████▊    | 19/33 [00:11<00:08,  1.73it/s]Evaluating:  61%|██████    | 20/33 [00:12<00:07,  1.67it/s]Evaluating:  64%|██████▎   | 21/33 [00:13<00:07,  1.62it/s]Evaluating:  67%|██████▋   | 22/33 [00:13<00:06,  1.58it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.57it/s]Evaluating:  73%|███████▎  | 24/33 [00:15<00:05,  1.57it/s]Evaluating:  76%|███████▌  | 25/33 [00:15<00:05,  1.56it/s]Evaluating:  79%|███████▉  | 26/33 [00:16<00:04,  1.56it/s]Evaluating:  82%|████████▏ | 27/33 [00:17<00:03,  1.55it/s]Evaluating:  85%|████████▍ | 28/33 [00:17<00:03,  1.55it/s]Evaluating:  88%|████████▊ | 29/33 [00:18<00:02,  1.55it/s]Evaluating:  91%|█████████ | 30/33 [00:18<00:01,  2.00it/s]Evaluating:  94%|█████████▍| 31/33 [00:19<00:01,  1.85it/s]Evaluating:  97%|█████████▋| 32/33 [00:19<00:00,  1.74it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.68it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

--- Ablating 50 random heads ---
Evaluating:   0%|          | 0/33 [00:00<?, ?it/s]Evaluating:   3%|▎         | 1/33 [00:00<00:20,  1.55it/s]Evaluating:   6%|▌         | 2/33 [00:01<00:19,  1.55it/s]Evaluating:   9%|▉         | 3/33 [00:01<00:19,  1.55it/s]Evaluating:  12%|█▏        | 4/33 [00:02<00:18,  1.53it/s]Evaluating:  15%|█▌        | 5/33 [00:03<00:18,  1.48it/s]Evaluating:  18%|█▊        | 6/33 [00:03<00:17,  1.51it/s]Evaluating:  21%|██        | 7/33 [00:04<00:17,  1.51it/s]Evaluating:  24%|██▍       | 8/33 [00:05<00:16,  1.51it/s]Evaluating:  27%|██▋       | 9/33 [00:05<00:15,  1.52it/s]Evaluating:  30%|███       | 10/33 [00:06<00:15,  1.53it/s]Evaluating:  33%|███▎      | 11/33 [00:06<00:11,  1.99it/s]Evaluating:  36%|███▋      | 12/33 [00:07<00:11,  1.83it/s]Evaluating:  39%|███▉      | 13/33 [00:08<00:11,  1.74it/s]Evaluating:  42%|████▏     | 14/33 [00:08<00:11,  1.68it/s]Evaluating:  45%|████▌     | 15/33 [00:09<00:10,  1.64it/s]Evaluating:  48%|████▊     | 16/33 [00:09<00:10,  1.61it/s]Evaluating:  52%|█████▏    | 17/33 [00:10<00:10,  1.59it/s]Evaluating:  55%|█████▍    | 18/33 [00:11<00:09,  1.56it/s]Evaluating:  58%|█████▊    | 19/33 [00:11<00:06,  2.02it/s]Evaluating:  61%|██████    | 20/33 [00:12<00:07,  1.84it/s]Evaluating:  64%|██████▎   | 21/33 [00:12<00:06,  1.74it/s]Evaluating:  67%|██████▋   | 22/33 [00:13<00:06,  1.66it/s]Evaluating:  70%|██████▉   | 23/33 [00:14<00:06,  1.62it/s]Evaluating:  73%|███████▎  | 24/33 [00:14<00:05,  1.60it/s]Evaluating:  76%|███████▌  | 25/33 [00:15<00:05,  1.59it/s]Evaluating:  79%|███████▉  | 26/33 [00:15<00:04,  1.58it/s]Evaluating:  82%|████████▏ | 27/33 [00:16<00:03,  1.56it/s]Evaluating:  85%|████████▍ | 28/33 [00:17<00:03,  1.56it/s]Evaluating:  88%|████████▊ | 29/33 [00:17<00:02,  1.55it/s]Evaluating:  91%|█████████ | 30/33 [00:18<00:01,  2.00it/s]Evaluating:  94%|█████████▍| 31/33 [00:18<00:01,  1.84it/s]Evaluating:  97%|█████████▋| 32/33 [00:19<00:00,  1.73it/s]Evaluating: 100%|██████████| 33/33 [00:20<00:00,  1.67it/s]                                                           Accuracy: 97.0% (drop: 0.0%)

Saved: /home/ubuntu/iahdClean/deliverable_head_analysis/phase3/retrieval_head_wu24/results/llama3_instruct/inc_state/tokens_2048.json

======================================================================
SUMMARY
======================================================================
Baseline accuracy: 97.0%

Top Heads Ablation:
  Top  5: 97.0% (drop: 0.0%)
  Top 10: 97.0% (drop: 0.0%)
  Top 20: 97.0% (drop: 0.0%)
  Top 30: 90.9% (drop: 6.1%)
  Top 40: 84.8% (drop: 12.1%)
  Top 50: 78.8% (drop: 18.2%)

Random Heads Ablation (baseline):
  Random  5: 97.0% (drop: 0.0%)
  Random 10: 97.0% (drop: 0.0%)
  Random 20: 100.0% (drop: -3.0%)
  Random 30: 97.0% (drop: 0.0%)
  Random 40: 97.0% (drop: 0.0%)
  Random 50: 97.0% (drop: 0.0%)
